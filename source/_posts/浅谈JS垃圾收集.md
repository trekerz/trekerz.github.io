---
title: 浅谈JS垃圾收集
subtitle: "JavaScript细节"
date: 2017-08-06 14:21:14
tags: 
	- 前端基础
	- JavaScript
layout: post
author: "Trekerz"
header-img: "/blog/bg-img/null170806.jpg"
---

JavaScript具有自动垃圾收集机制，开发人员不用再关心内存使用问题，所需内存的分配以及无用内存的回收完全实现了自动管理。

**垃圾收集机制的原理**：找出那些不再继续使用的变量，然后释放其占用的内存。为此，垃圾收集器会按照固定的时间间隔或代码中预定的收集时间周期性地执行这一操作。

### **一、标记清除**

依靠作用域。

**简单来说**：当变量进入环境时（例如在函数中声明一个变量），就将它标记“进入环境”。当变量离开环境时，则将其标记为“离开环境”。

**如何标记**：

1. 给存储在内存中的**所有变量都加上标记**。

2. 去掉**环境中的变量**以及**被环境中的变量引用的变量**的标记。

3. 在此之后再被加上标记的变量将被视为准备删除的变量。

4. 完成内存清除工作，销毁那些带标记的值并回收它们所占用的内存。

### **二、引用计数（不太常见）**

依靠引用的次数。

**简单来说**：跟踪记录每个值被引用的次数。当声明了一个变量并将一个引用类型值赋给该变量时，则这个值的应用次数就是1。当这个值的引用次数变为0时，则说明没有办法再访问这个值了，因而就可以将其占用的内存空间回收回来。

**存在问题**：当两个变量**循环引用**时，变量的引用次数在离开作用域后不会变为0。

**解决方法**：手动设两个引用都为null。

### **三、性能问题**

1. IE7以前的垃圾收集器是根据内存分配量来运行的。当内存使用量达到临界值时就会运行收集器。IE设置的临界值导致了收集器频繁运行，从而导致了性能问题。​IE7的垃圾收集例程改变了工作方式，临界值被修改为**动态修正**。 


2. 有的浏览器可以**手动触发**垃圾收集过程。

### **四、管理内存**

由于浏览器可用内存通常比桌面应用少，所以优化内存的最佳方式就是为执行中的代码只保存必要的数据，一旦数据不再有用，最好通过将其设置为null来释放其应用，即**解除引用**。

解除引用的真正作用是**让值脱离执行环境，以便垃圾收集器下次运行时将其回收**。

<br/>

<center>-&nbsp;*end*&nbsp;-</center>

<br/>