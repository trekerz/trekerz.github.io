<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="庄嘉峰在 Github 上的个人博客">
    <meta name="keyword" content="trekerz blog github">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="/favicon.png">
    <link rel="alternate" type="application/atom+xml" title="Trekerz" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        CSS格式化上下文概念解析｜Trekerz&#39;s blog
        
    </title>

    <link rel="canonical" href="http://trekerz.github.io/2017/11/22/CSS格式化上下文概念解析/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/blog-style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
</head>

<style>

    header.intro-header {
        background-image: url('http://prjadt00w.bkt.clouddn.com/default-img.jpg')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Trekerz
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
					
                    
                        
							
                        <li>
                            <a href="/ABOUT/">ABOUT</a>
                        </li>
							
						
                    
                        
							
                        <li>
                            <a href="/ARCHIVE/">ARCHIVE</a>
                        </li>
							
						
                    
                        
							
                        <li>
                            <a href="/TAGS/">TAGS</a>
                        </li>
							
						
                    
					
					
                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img"
     src="https://h1.ioliu.cn/bing/SerengetiZebra_ZH-CN9007197602_1920x1080.jpg">


<style>
    
    header.intro-header {
        background-image: url('https://h1.ioliu.cn/bing/SerengetiZebra_ZH-CN9007197602_1920x1080.jpg')
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>CSS格式化上下文概念解析</h1>
                    
                    <h2 class="subheading">BFC(详细)、IFC、GFC、FFC</h2>
                    
                    <span class="meta">
                         作者 Trekerz
                        <span>
                          日期 2017-11-22
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                        <a class="tag" href="/TAGS/#前端基础"
                           title="前端基础">前端基础</a>
                        
                        <a class="tag" href="/TAGS/#CSS"
                           title="CSS">CSS</a>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            CSS格式化上下文概念解析
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <p>前几天在看flex布局的时候遇到了BFC这个概念，于是顺便看了几篇相关的文章，了解了几种上下文布局的基本概念，归结如下。<br>今天在看flex布局的时候遇到了BFC这个概念，于是顺便看了几篇相关的文章，了解了几种上下文布局的基本概念，归结如下。</p>
<p>FC的全称是：<strong>Formatting Contexts（格式化上下文）</strong>，是W3C CSS2.1规范中的一个概念，具体包含了BFC、IFC、GFC、FFC四种。它们是页面中的一块渲染区域，并且各自拥有一套渲染规则，它决定了其子元素将如何定位，以及和其他元素的关系和相互作用。</p>
<h2 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a><strong>BFC</strong></h2><p>BFC(Block Formatting Contexts)意为“块级格式化上下文”。就是页面上一个<strong>独立的</strong>渲染区域，只有Block-level Box参与，该区域拥有一套渲染规则来约束块级盒子的布局，且与区域外部无关。</p>
<p>如何生成BFC呢： </p>
<ul>
<li>float的值不为none；</li>
<li>overflow的值不为visible；</li>
<li>position的值不为relative和static；</li>
<li>display的值为table-cell,table-caption何inline-block中的任何一个。</li>
</ul>
<p><strong>举几个例子说明下BFC的具体作用</strong>：</p>
<h4 id="1-包含浮动元素"><a href="#1-包含浮动元素" class="headerlink" title="(1) 包含浮动元素"></a><strong>(1) 包含浮动元素</strong></h4><p><strong>问题</strong>：父子div中的子div设置了浮动，父元素会发生高度坍塌，造成上下边界重合。</p>
<p><img src="1.png" alt="img"></p>
<p><strong>解决</strong>：触发父div的BFC布局，使元素的渲染不受外部元素的影响。比如可以按需设置<code>position: absolute;</code>或者<code>overflow: hidden;</code>。</p>
<h4 id="2-不被浮动元素覆盖"><a href="#2-不被浮动元素覆盖" class="headerlink" title="(2) 不被浮动元素覆盖"></a><strong>(2) 不被浮动元素覆盖</strong></h4><p><strong>问题</strong>：兄弟div中的哥哥div设置了浮动，弟弟div会被哥哥div遮挡。</p>
<p><img src="2.png" alt="img"></p>
<p>解决：触发弟弟div的BFC布局，使弟弟div不受外部元素影响。比如给弟弟div设置<code>overflow: hidden;</code>之后：</p>
<p><img src="3.png" alt="img"></p>
<h4 id="3-阻止外边距重叠"><a href="#3-阻止外边距重叠" class="headerlink" title="(3) 阻止外边距重叠"></a><strong>(3) 阻止外边距重叠</strong></h4><p><strong>问题</strong>：在普通流中，根据BFC规则，块级元素在竖直方向上的margin是会重叠的，二者之间的margin最终会以大者为准。例如下图两框之间的margin就只有20px：</p>
<p><img src="4.png" alt="img"></p>
<p><strong>解决</strong>：这里margin会重叠的根本原因就是二者同处在一个BFC独立区域内，适用BFC布局规则（也就是竖直方向的margin会重叠）。解决这个问题的关键就是为其中一个框单独设置BFC区域，使它与外部区域隔离开。这里为绿框div设置<code>float: left;</code>，使其成为拥有BFC的元素，它就不受外部影响了，于是margin就变成了30px：</p>
<p><img src="5.png" alt="img"></p>
<h4 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a><strong>感悟</strong></h4><p>进一步总结一下：为何(3)中设置了<code>float: left;</code>之后就不适用BFC规则了呢？这里面到底有什么“神秘的规则”在主导着？</p>
<p>在w3关于BFC的描述章节中（<a href="http://www.w3.org/TR/CSS21/visuren.html" target="_blank" rel="external">CSS21-9.4.1</a>）可以找到如下一段话：</p>
<blockquote>
<p>Floats, absolutely positioned elements, block containers (such as inline-blocks, table-cells, and table-captions) that are not block boxes, and block boxes with ‘overflow’ other than ‘visible’ (except when that value has been propagated to the viewport) establish new block formatting contexts for their contents.</p>
</blockquote>
<p>大致意思是：浮动元素、绝对定位元素、不是块级盒的块级包含块(比如inline-block、table-cell、table-capation)、overflow值不为visible的块级盒子，为它们的内容建立了一个新的块级排版上下文。</p>
<p>可以发现：这里提到的这几类元素就是开头提到的生成BFC的那几种途径。BFC的官方文档规定了BFC的作用范围仅限于普通文档流，以上四类元素由于脱离了普通流，它们就可以用于建立新的BFC作用范围（块级排版上下文）。</p>
<p>再回到问题(3)中来：上面的绿框设置了<code>float: left;</code>后，它已经变成了一个新的块级排版上下文，独立于外部的上下文，所以内外之间已经不适用BFC规则了，于是margin也就不重叠了。</p>
<h2 id="IFC"><a href="#IFC" class="headerlink" title="IFC"></a><strong>IFC</strong></h2><p>IFC(Inline Formatting Contexts)意为“内联格式化上下文”，IFC中，盒子依次水平放置，从包含块的顶部开始。 </p>
<h2 id="GFC"><a href="#GFC" class="headerlink" title="GFC"></a><strong>GFC</strong></h2><p>GFC(GridLayout Formatting Contexts)意为“网格布局格式化上下文”当一个元素设置为<code>display:grid;</code>的时候，此元素将获得一个独立的渲染区域，可以在网格容器上定义网格行和列，为每一个网格定义位置和空间。GFC和table的区别在于GridLayout会有更加丰富的属性来控制行列，控制对齐以及更为精细的渲染。 </p>
<h2 id="FFC"><a href="#FFC" class="headerlink" title="FFC"></a><strong>FFC</strong></h2><p>FFC(Flex Formatting Contexts)意为“自适应格式化上下文”，<code>display</code>值为<code>flex</code>或者<code>inline-flex</code>的元素将会生成自适应容器，当前只有谷歌和火狐支持该属性，不过在移动端几乎没有障碍(移动端是chrome和Safari的天下)。flex box由伸缩容器和伸缩子元素组成。通过设置元素<code>display:flex/inline-flex;</code>可以得到伸缩容器，前者为块级元素，后者为行内元素。伸缩容器外元素不受影响。</p>
<p><br></p>
<center>-&nbsp;<em>end</em>&nbsp;-</center>

<p><br></p>

                <hr>
                

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/11/27/在JS中用for-in-遍历数组的问题与解决/" data-toggle="tooltip" data-placement="top"
                           title="JS中用for...in...遍历数组遇到的坑">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/11/21/CSS处理居中问题总结/" data-toggle="tooltip" data-placement="top"
                           title="CSS处理居中问题总结">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                

                


                <!--加入新的评论系统-->
                
            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#BFC"><span class="toc-text">BFC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-包含浮动元素"><span class="toc-text">(1) 包含浮动元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-不被浮动元素覆盖"><span class="toc-text">(2) 不被浮动元素覆盖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-阻止外边距重叠"><span class="toc-text">(3) 阻止外边距重叠</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#感悟"><span class="toc-text">感悟</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IFC"><span class="toc-text">IFC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GFC"><span class="toc-text">GFC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FFC"><span class="toc-text">FFC</span></a></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/TAGS/">标签</a>
                    </h5>
                    <div class="tags">
                        
                        <a class="tag" href="/TAGS/#前端基础"
                           title="前端基础">前端基础</a>
                        
                        <a class="tag" href="/TAGS/#CSS"
                           title="CSS">CSS</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <div style="margin-top: 20px;">
                    <h5 class="text-center">友链</h5>
                    <ul class="list-inline text-center">
                        
                        <li><a href="https://juejin.im">掘金</a></li>
                        
                        <li><a href="https://www.oschina.net/project/lang/28/javascript">开源中国</a></li>
                        
                        <li><a href="http://www.jianshu.com/">简书</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>

    </div>
</article>







<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                    <li>
                        <a target="_blank" href="https://twitter.com/GarfunkelZhuang" class="twitter-logo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                
                
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/trekerz" class="zhihu-logo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/zjfjz" class="weibo-logo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/trekerz" class="github-logo">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Trekerz 2020
                    <br>
                    <span id="busuanzi_container_site_pv" style="font-size: 12px;">PV: <span id="busuanzi_value_site_pv"></span> Times</span>
                    <br>
                    Powered by <a href="https://hexo.io/">Hexo</a>
                </p>

            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://trekerz.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    var _baId = 'e3e6f83e945518142f014116fc5aacc7';
    // Originial
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + _baId;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','','2.0.0');
</script>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!--wechat title img-->
<img class="wechat-title-img" src="http://prjadt00w.bkt.clouddn.com/avator.jpg">
</body>

</html>
